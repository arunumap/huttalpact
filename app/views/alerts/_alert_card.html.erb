<%= turbo_frame_tag dom_id(alert) do %>
  <div class="rounded-lg bg-white shadow-sm ring-1 ring-gray-200 overflow-hidden">
    <div class="flex items-start gap-4 p-4">
      <%# Icon %>
      <div class="shrink-0 mt-0.5">
        <% case urgency %>
        <% when :overdue %>
          <div class="flex h-9 w-9 items-center justify-center rounded-full bg-red-100">
            <svg class="h-5 w-5 text-red-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
            </svg>
          </div>
        <% when :today %>
          <div class="flex h-9 w-9 items-center justify-center rounded-full bg-amber-100">
            <svg class="h-5 w-5 text-amber-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
        <% when :scheduled %>
          <div class="flex h-9 w-9 items-center justify-center rounded-full bg-gray-100">
            <svg class="h-5 w-5 text-gray-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
        <% else %>
          <div class="flex h-9 w-9 items-center justify-center rounded-full bg-blue-100">
            <svg class="h-5 w-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0" />
            </svg>
          </div>
        <% end %>
      </div>

      <%# Content %>
      <div class="flex-1 min-w-0">
        <div class="flex items-center gap-2 mb-1">
          <%= alert_type_badge(alert.alert_type) %>
          <%= alert_urgency_label(alert) %>
        </div>
        <p class="text-sm font-medium text-gray-900"><%= alert.display_message %></p>
        <div class="mt-1 flex items-center gap-3 text-xs text-gray-500">
          <%= link_to alert.contract.title, contract_path(alert.contract), class: "font-medium text-amber-600 hover:text-amber-700" %>
          <% if alert.contract.vendor_name.present? %>
            <span>·</span>
            <span><%= alert.contract.vendor_name %></span>
          <% end %>
          <span>·</span>
          <span>
            <% if alert.overdue? %>
              <%= pluralize((Date.current - alert.trigger_date).to_i, "day") %> overdue
            <% elsif alert.due_today? %>
              Due today
            <% else %>
              Due <%= alert.trigger_date.strftime("%b %d, %Y") %>
            <% end %>
          </span>
        </div>
      </div>

      <%# Actions %>
      <div class="shrink-0 flex items-center gap-2">
        <%# Snooze dropdown %>
        <div data-controller="snooze-dropdown" class="relative">
          <button data-action="click->snooze-dropdown#toggle" type="button" class="rounded-md bg-white px-2.5 py-1.5 text-xs font-medium text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">
            Snooze
          </button>
          <div data-snooze-dropdown-target="menu" class="hidden absolute right-0 top-full mt-1 w-36 rounded-md bg-white shadow-lg ring-1 ring-black/5 z-50 py-1">
            <% [1, 3, 7, 14].each do |days| %>
              <%= button_to "#{days} #{"day".pluralize(days)}",
                  snooze_alert_path(alert, days: days),
                  method: :patch,
                  class: "block w-full px-3 py-1.5 text-left text-xs text-gray-700 hover:bg-gray-100" %>
            <% end %>
          </div>
        </div>

        <%# Acknowledge %>
        <%= button_to acknowledge_alert_path(alert),
            method: :patch,
            class: "rounded-md bg-amber-600 px-2.5 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-amber-500" do %>
          Acknowledge
        <% end %>
      </div>
    </div>
  </div>
<% end %>
