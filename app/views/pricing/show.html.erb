<% content_for :page_title, "Pricing" %>
<% content_for :title, "Pricing — HuttalPact Contract Tracking" %>
<% content_for :meta_description, "Simple, transparent pricing for AI-powered contract tracking. Start free with 10 contracts and 5 AI extractions/month. Starter plan at $49/mo or Pro at $149/mo as you grow." %>
<% content_for :canonical_url, pricing_url %>

<div class="mx-auto max-w-5xl py-12 px-4" data-controller="pricing-toggle">
  <div class="text-center">
    <h2 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">Simple, transparent pricing</h2>
    <p class="mt-4 text-lg text-gray-500">Smart contract tracking that won't let you forget. Start free, upgrade when you need more.</p>
  </div>

  <%# Billing toggle %>
  <div class="mt-8 flex justify-center">
    <div class="relative flex rounded-full bg-gray-100 p-1">
      <button type="button" data-action="click->pricing-toggle#selectMonthly" data-pricing-toggle-target="monthlyBtn"
              class="relative rounded-full px-4 py-2 text-sm font-semibold bg-white text-gray-900 shadow-sm">
        Monthly
      </button>
      <button type="button" data-action="click->pricing-toggle#selectAnnual" data-pricing-toggle-target="annualBtn"
              class="relative rounded-full px-4 py-2 text-sm font-semibold text-gray-500">
        Annual <span class="ml-1 text-xs font-medium text-amber-600">Save 17%</span>
      </button>
    </div>
  </div>

  <%# Pricing cards %>
  <div class="mt-10 grid grid-cols-1 gap-6 sm:grid-cols-3">
    <%# Free %>
    <div class="relative rounded-2xl bg-white p-8 shadow-sm ring-1 ring-gray-200">
      <h3 class="text-lg font-semibold text-gray-900">Free</h3>
      <p class="mt-1 text-sm text-gray-500">Get started with the basics.</p>
      <div class="mt-6">
        <span class="text-4xl font-bold text-gray-900">$0</span>
        <span class="text-sm text-gray-500">/month</span>
      </div>
      <ul class="mt-8 space-y-3 text-sm text-gray-600">
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          Up to 10 contracts
        </li>
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          5 AI extractions/month
          <span title="AI-powered extraction reads your contract documents and fills in key fields like dates, values, and parties automatically." class="cursor-help text-gray-400 hover:text-gray-600">
            <svg class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z" /></svg>
          </span>
        </li>
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          1 user
        </li>
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          Email & in-app alerts
        </li>
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          CSV export
        </li>
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          7-day activity log
        </li>
      </ul>
      <div class="mt-8">
        <% if Current.user && @current_plan == "free" %>
          <span class="block w-full rounded-lg bg-gray-100 px-4 py-2.5 text-center text-sm font-semibold text-gray-500">Current Plan</span>
        <% elsif Current.user %>
          <span class="block w-full rounded-lg bg-gray-50 px-4 py-2.5 text-center text-sm font-medium text-gray-400">—</span>
        <% else %>
          <%= link_to "Get Started", new_registration_path, class: "block w-full rounded-lg bg-gray-900 px-4 py-2.5 text-center text-sm font-semibold text-white hover:bg-gray-800 transition" %>
        <% end %>
      </div>
    </div>

    <%# Starter %>
    <div class="relative rounded-2xl bg-white p-8 shadow-sm ring-2 ring-amber-500">
      <div class="absolute -top-3 left-1/2 -translate-x-1/2">
        <span class="inline-flex items-center rounded-full bg-amber-500 px-3 py-1 text-xs font-semibold text-white">Most Popular</span>
      </div>
      <h3 class="text-lg font-semibold text-gray-900">Starter</h3>
      <p class="mt-1 text-sm text-gray-500">For growing property managers.</p>
      <div class="mt-6">
        <span data-pricing-toggle-target="starterPrice" class="text-4xl font-bold text-gray-900 transition-opacity duration-150">$49</span>
        <span data-pricing-toggle-target="starterPeriod" class="text-sm text-gray-500">/month</span>
        <span data-pricing-toggle-target="starterAnnualTotal" class="hidden block mt-1 text-xs text-gray-400">(billed as $492/year)</span>
      </div>
      <ul class="mt-8 space-y-3 text-sm text-gray-600">
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          Up to 100 contracts
        </li>
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          50 AI extractions/month
          <span title="AI-powered extraction reads your contract documents and fills in key fields like dates, values, and parties automatically." class="cursor-help text-gray-400 hover:text-gray-600">
            <svg class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z" /></svg>
          </span>
        </li>
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          Up to 5 team members
        </li>
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          Email & in-app alerts
        </li>
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          Priority support
        </li>
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          30-day activity log
        </li>
      </ul>
      <div class="mt-8">
        <% if Current.user && @current_plan == "starter" %>
          <span class="block w-full rounded-lg bg-amber-50 px-4 py-2.5 text-center text-sm font-semibold text-amber-700 ring-1 ring-amber-200">Current Plan</span>
        <% elsif Current.user && !@is_owner %>
          <span class="block w-full rounded-lg bg-gray-100 px-4 py-2.5 text-center text-xs font-medium text-gray-500">Contact your organization owner to upgrade</span>
        <% elsif Current.user %>
          <%= button_to "Upgrade to Starter", checkout_billing_path,
            params: { price_id: PlanLimits::STRIPE_PRICES["starter_monthly"] },
            data: { pricing_toggle_target: "starterBtn", pricing_toggle_monthly_price_param: PlanLimits::STRIPE_PRICES["starter_monthly"], pricing_toggle_annual_price_param: PlanLimits::STRIPE_PRICES["starter_annual"] },
            class: "block w-full rounded-lg bg-amber-600 px-4 py-2.5 text-center text-sm font-semibold text-white hover:bg-amber-500 transition" %>
        <% else %>
          <%= link_to "Get Started", new_registration_path, class: "block w-full rounded-lg bg-amber-600 px-4 py-2.5 text-center text-sm font-semibold text-white hover:bg-amber-500 transition" %>
        <% end %>
      </div>
    </div>

    <%# Pro %>
    <div class="relative rounded-2xl bg-white p-8 shadow-sm ring-1 ring-gray-200">
      <h3 class="text-lg font-semibold text-gray-900">Pro</h3>
      <p class="mt-1 text-sm text-gray-500">For large portfolios & teams.</p>
      <div class="mt-6">
        <span data-pricing-toggle-target="proPrice" class="text-4xl font-bold text-gray-900 transition-opacity duration-150">$149</span>
        <span data-pricing-toggle-target="proPeriod" class="text-sm text-gray-500">/month</span>
        <span data-pricing-toggle-target="proAnnualTotal" class="hidden block mt-1 text-xs text-gray-400">(billed as $1,490/year)</span>
      </div>
      <ul class="mt-8 space-y-3 text-sm text-gray-600">
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          <strong>Unlimited</strong> contracts
        </li>
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          <strong>Unlimited</strong> AI extractions
        </li>
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          <strong>Unlimited</strong> team members
        </li>
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          Email & in-app alerts
        </li>
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          Priority support
        </li>
        <li class="flex items-center gap-2">
          <svg class="h-5 w-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          <strong>Full</strong> activity history
        </li>
      </ul>
      <div class="mt-8">
        <% if Current.user && @current_plan == "pro" %>
          <span class="block w-full rounded-lg bg-gray-100 px-4 py-2.5 text-center text-sm font-semibold text-gray-500">Current Plan</span>
        <% elsif Current.user && !@is_owner %>
          <span class="block w-full rounded-lg bg-gray-100 px-4 py-2.5 text-center text-xs font-medium text-gray-500">Contact your organization owner to upgrade</span>
        <% elsif Current.user %>
          <%= button_to "Upgrade to Pro", checkout_billing_path,
            params: { price_id: PlanLimits::STRIPE_PRICES["pro_monthly"] },
            data: { pricing_toggle_target: "proBtn", pricing_toggle_monthly_price_param: PlanLimits::STRIPE_PRICES["pro_monthly"], pricing_toggle_annual_price_param: PlanLimits::STRIPE_PRICES["pro_annual"] },
            class: "block w-full rounded-lg bg-gray-900 px-4 py-2.5 text-center text-sm font-semibold text-white hover:bg-gray-800 transition" %>
        <% else %>
          <%= link_to "Get Started", new_registration_path, class: "block w-full rounded-lg bg-gray-900 px-4 py-2.5 text-center text-sm font-semibold text-white hover:bg-gray-800 transition" %>
        <% end %>
      </div>
    </div>
  </div>

  <%# FAQ Section %>
  <div class="mt-16 mx-auto max-w-3xl">
    <h3 class="text-xl font-bold text-gray-900 text-center">Frequently Asked Questions</h3>
    <dl class="mt-8 space-y-4">
      <details class="group rounded-lg bg-white px-6 py-4 shadow-sm ring-1 ring-gray-200">
        <summary class="flex cursor-pointer items-center justify-between text-sm font-semibold text-gray-900">
          Can I change plans later?
          <svg class="h-5 w-5 shrink-0 text-gray-400 group-open:rotate-180 transition-transform" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" /></svg>
        </summary>
        <p class="mt-3 text-sm text-gray-600">Yes! You can upgrade or downgrade your plan at any time. When you upgrade, you'll get immediate access to increased limits. When you downgrade, the change takes effect at the end of your current billing period.</p>
      </details>

      <details class="group rounded-lg bg-white px-6 py-4 shadow-sm ring-1 ring-gray-200">
        <summary class="flex cursor-pointer items-center justify-between text-sm font-semibold text-gray-900">
          How do AI extractions work?
          <svg class="h-5 w-5 shrink-0 text-gray-400 group-open:rotate-180 transition-transform" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" /></svg>
        </summary>
        <p class="mt-3 text-sm text-gray-600">Upload a contract document (PDF, Word, or image) and our AI reads the document to automatically fill in key fields like dates, values, vendor names, and renewal terms. Each extraction counts towards your monthly limit, which resets on the 1st of each month.</p>
      </details>

      <details class="group rounded-lg bg-white px-6 py-4 shadow-sm ring-1 ring-gray-200">
        <summary class="flex cursor-pointer items-center justify-between text-sm font-semibold text-gray-900">
          What happens when I hit my limit?
          <svg class="h-5 w-5 shrink-0 text-gray-400 group-open:rotate-180 transition-transform" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" /></svg>
        </summary>
        <p class="mt-3 text-sm text-gray-600">You'll still have full access to your existing contracts and data. You won't be able to add new contracts or run AI extractions until you upgrade or your monthly extraction count resets. We'll warn you when you're getting close to a limit.</p>
      </details>

      <details class="group rounded-lg bg-white px-6 py-4 shadow-sm ring-1 ring-gray-200">
        <summary class="flex cursor-pointer items-center justify-between text-sm font-semibold text-gray-900">
          Can I cancel anytime?
          <svg class="h-5 w-5 shrink-0 text-gray-400 group-open:rotate-180 transition-transform" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" /></svg>
        </summary>
        <p class="mt-3 text-sm text-gray-600">Absolutely. You can cancel your subscription at any time from the Billing page. You'll retain access to your paid plan features through the end of your current billing period, then your account will revert to the Free plan.</p>
      </details>

      <details class="group rounded-lg bg-white px-6 py-4 shadow-sm ring-1 ring-gray-200">
        <summary class="flex cursor-pointer items-center justify-between text-sm font-semibold text-gray-900">
          Do you offer refunds?
          <svg class="h-5 w-5 shrink-0 text-gray-400 group-open:rotate-180 transition-transform" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" /></svg>
        </summary>
        <p class="mt-3 text-sm text-gray-600">If you're not satisfied within the first 14 days, contact us and we'll provide a full refund. After that, you can cancel at any time but refunds are not issued for partial billing periods.</p>
      </details>
    </dl>
  </div>
</div>
